---
import BaseLayout from '../../../../layouts/BaseLayout.astro';
import { getLangFromUrl, useTranslations } from '../../../../i18n/utils';
import type { Post } from '../../../../../types'; // Importa la interfaz (¡ahora debería funcionar!)


const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const post = Object.values(import.meta.glob('./*.md', { eager: true })).find(post => post.file === `./${lang}/${Astro.params.postSlug}.md`);

if (!post) {
  return new Response("Post not found", { status: 404 });
}

const formattedDate = post.data.date.toLocaleDateString(lang);
const pageTitle = post.data.title;
const { Content } = await post.render();
---

<BaseLayout pageTitle={pageTitle}>
  <h1>{post.data.title}</h1>
  <p>by {post.data.author} • {formattedDate}</p>
  <Content />
</BaseLayout>